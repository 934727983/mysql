# 修改延迟阈值和读权重分配 {#concept_ldz_h4p_wdb .concept}

开通了读写分离功能后，您可以根据需求修改读写分离的延迟阈值和读权重分配，具体介绍请参见[MySQL读写分离参数说明](#table_hyx_fjt_bfb)或[SQL Server读写分离参数说明](#table_rvd_g53_wfb)。

**说明：** SQL Server 2017暂不支持设置延迟阈值。

## MySQL操作步骤 {#section_rbc_l4p_wdb .section}

1.  登录[RDS管理控制台](https://rdsnew.console.aliyun.com/console/index#/rdsList/)。
2.  在页面左上角，选择实例所在地域。

    ![地域截图](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/7882/154804043637169_zh-CN.png)

3.  找到目标实例，单击实例ID。
4.  在左侧导航栏中单击**数据库连接**或**数据库代理**。
5.  选择**读写分离**标签页。
6.  单击**设置读写分离**，修改设置信息。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/7916/15480404363100_zh-CN.png)

    |参数|说明|
    |--|--|
    |延迟阈值|只读实例同步主实例数据时允许的最长延迟时间。为避免只读实例读取的数据长时间和主实例不一致，当一个只读实例的延迟时间超过设置的延迟阈值，则不论该只读实例的读权重是多少，读请求都不会转发至该只读实例。取值范围为0秒到7200秒。受限于SQL的执行情况，只读实例有一定的几率会出现延迟，建议该值不小于30秒。

|
    |读权重分配|实例的读权重越高，处理的读请求越多。例如，假设主实例有3个只读实例，读权重分别为0、100、200、0，则表示主实例不处理读请求（写请求仍然自动发往主实例），前两个只读实例按照1：2的比例处理读请求，第三个只读实例不会收到任何读写请求。    -   **系统分配**：系统根据实例规格自动分配各个实例的读权重。后续该主实例下新增的只读实例也会自动按照系统分配的权重加入到读写分离链路中，无需手动设置。更多信息请参见[系统权重分配规则](intl.zh-CN/用户指南/读写分离/系统权重分配规则.md#)。
    -   **自定义**：手动设置各个实例的读权重，范围为0至10000。后续该主实例下新增只读实例的读权重默认为0，需要您手动修改。
**说明：** 

    -   若只读实例被删除，则该实例的权重会被自动移除，其他实例权重不变。
    -   不支持为已经设置[只读实例延时复制](intl.zh-CN/用户指南/实例管理/只读实例延时复制.md#)时间的实例设置权重。
|

7.  单击**确定**。

## SQL Server操作步骤 {#section_f3l_nt3_wfb .section}

1.  登录[RDS管理控制台](https://rdsnew.console.aliyun.com/console/index#/rdsList/)。
2.  在页面左上角，选择实例所在地域。

    ![地域截图](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/7882/154804043637169_zh-CN.png)

3.  找到目标实例，单击实例ID。
4.  在左侧导航栏中单击**集群管理**。
5.  单击右上角**设置只读实例**，修改设置。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/7916/154804043732605_zh-CN.png)

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/7916/154804043732606_zh-CN.png)

    |参数|说明|
    |--|--|
    |读权重分配|实例的读权重越高，处理的读请求越多。例如，假设主实例有3个只读实例，读权重分别为100、200、200，则表示3个只读实例按照1：2：2的比例处理读请求。    -   **系统分配**：系统根据实例规格自动分配各个实例的读权重。后续该主实例下新增的只读实例也会自动按照系统分配的权重加入到读写分离链路中，无需手动设置。更多信息请参见[系统权重分配规则](intl.zh-CN/用户指南/读写分离/系统权重分配规则.md#)。
    -   **自定义**：手动设置各个实例的读权重，范围为0至10000。后续该主实例下新增只读实例的读权重默认为0，需要您手动修改。
**说明：** 

    -   若只读实例被删除，则该实例的权重会被自动移除，其他实例权重不变。
    -   主实例默认不处理读请求（写请求仍然自动发往主实例）。
|


