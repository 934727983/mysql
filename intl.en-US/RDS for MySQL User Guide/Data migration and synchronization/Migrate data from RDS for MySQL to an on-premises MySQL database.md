# Migrate data from RDS for MySQL to an on-premises MySQL database {#concept_rw4_2xv_ydb .concept}

You can migrate data from RDS for MySQL to an on-premises MySQL database through a physical backup file and through a logical backup file.

## Migrate data by using a physical backup file {#section_xyk_kyv_ydb .section}

 **Background information** 

Due to software restrictions, you can restore data only in a Linux operating system. If you want to restore data to a Windows operating system, then you must first restore data to Linux and then migrate the data to Windows.

 **Prerequisites** 

Percona XtraBackup has been installed in your operating system. MySQL 5.6 and earlier versions require Percona XtraBackup 2.3. MySQL 5.7 requires Percona XtraBackup 2.4. You can download and install Percona XtraBackup from its official website. For more information, see [Percona XtraBackup 2.3](https://www.percona.com/doc/percona-xtrabackup/2.3/installation.html?spm=a2c4g.11186623.2.4.53095cf8JeLIpU) and [Percona XtraBackup 2.4](https://www.percona.com/doc/percona-xtrabackup/2.4/installation.html?spm=0.0.0.0.4YVMLJ) at the official website.

 **Procedure** 

This example assumes that your on-premises server runs the RHEL6/x64 operating system and the path for storing the physical backup file is /home/mysql/.

1.  Download the physical backup file of the source RDS for MySQL instance and upload the file to the destination server. For more information about how to obtain the physical backup file, see [Download the data backup files and log backup files of an RDS for MySQL instance](intl.en-US/RDS for MySQL User Guide/Database backup/Download the data backup files and log backup files of an RDS for MySQL instance.md#). If the destination server can access the source RDS for MySQL instance, then you can run the wget "url" command to download the physical backup file. url in the command indicates the URL from which you can download the physical backup file.
2.  Go to the path where the physical backup file is saved.

    ``` {#codeblock_04d_g7v_s1b}
    cd /home/mysql/
    ```

3.  Decompress the physical backup file.

    ``` {#codeblock_efj_h7b_1kn}
    tar vizxf filename.tar.gz
    ```

     filename.tar.gz indicates the name of the physical backup file.

4.  Check whether the databases contained in the physical backup file after compression are correct.

    ``` {#codeblock_o49_xc8_9ka}
     cd filename/ll
    ```

    The system displays the following information, where db0dz1rv11f44yg2, mysql, and test are the databases in the source RDS for MySQL instance:

    ``` {#codeblock_hsz_qm5_klt}
    -rw-r--r-- 1 root root       269 Aug 19 18:15 backup-my.cnf
    drwxr-xr-x 2 root root      4096 Aug 21 10:31 db0dz1rv11f44yg2
    -rw-rw---- 1 root root 209715200 Aug  7 10:44 ibdata1
    drwxr-xr-x 2 root root      4096 Aug 21 10:31 mysql
    drwxr-xr-x 2 root root      4096 Aug 21 10:31 test
    -rw-r--r-- 1 root root        10 Aug 19 18:15 xtrabackup_binary
    -rw-r--r-- 1 root root        23 Aug 19 18:15 xtrabackup_binlog_info
    -rw-r--r-- 1 root root        77 Aug 19 18:15 xtrabackup_checkpoints
    -rw-r--r-- 1 root root      2560 Aug 19 18:15 xtrabackup_logfile
    -rw-r--r-- 1 root root        72 Aug 19 18:15 xtrabackup_slave_info
    ```

5.  Recover the data file.

    ``` {#codeblock_bk1_qyv_gxk}
     innobackupex --defaults-file=./backup-my.cnf --apply-log . /
    ```

    When the system displays `innobackupex: completed OK!`, the data is restored.

6.  Modify the configuration file. Comment out `innodb_fast_checksum`, `innodb_page_size`, and `innodb_log_block_size` in the decompressed file backup-my.cnf, and add `datadir=/home/mysql` to the file.

    ``` {#codeblock_hp8_oxy_26x}
    # This MySQL options file was generated by innobackupex-1.5.1.
    # The MySQL Server
    [mysqld]
    innodb_data_file_path=ibdata1:200M:autoextend
    innodb_log_files_in_group=2
    innodb_log_file_size=524288000
    #innodb_fast_checksum=0
    #innodb_page_size=16364
    #innodb_log_block_size=512
    datadir=/home/mysql/
    ```

7.  Reinstall MySQL to obtain the root permissions.

    ``` {#codeblock_dad_36g_rus}
    rm -rf mysql
    mysql_install_db --user=mysql --datadir=/home/mysql/
    ```

    When the system displays the following information, MySQL is reinstalled:

    ``` {#codeblock_anf_c88_rjo}
    Installing MySQL system table...
    OK
    Filling help table...
    OK
    ```

8.  Modify the file owner.

    ``` {#codeblock_j9j_8dj_me0}
    chown -R mysql:mysql /home/mysql/
    ```

9.  Start the MySQL process.

    ``` {#codeblock_tx1_cm7_5uf}
    mysqld_safe --defaults-file=/home/mysql/backup-my.cnf &
    ```

10. Log on to the database from a client.

    ``` {#codeblock_z9x_xxz_02c}
    mysql –u root –p
    ```

11. Verify the database integrity.

    ``` {#codeblock_or2_evc_gis}
    show databases;
    ```

    When the system displays the following information, the database is restored:

    ``` {#codeblock_ev0_703_ugy}
    +--------------------+
    | Database           |
    +--------------------+
    | information_schema |
    | db0dz1rv11f44yg2   |
    | mysql              |
    | performance_schema |
    | test               |
    +--------------------+
    ```


## Migrate data by using a logical backup file {#section_ydy_syv_ydb .section}

This example assumes that your on-premises server runs the RHEL6/x64 operating system and the path for storing the logical backup file is /home/mysql/.

 **Procedure** 

1.  Download the logical backup file of the source RDS for MySQL instance and upload the file to the destination server. For more information about how to obtain the logical backup file, see [Download the data backup files and log backup files of an RDS for MySQL instance](intl.en-US/RDS for MySQL User Guide/Database backup/Download the data backup files and log backup files of an RDS for MySQL instance.md#). If the destination server can access the source RDS for MySQL instance, you can run the wegt "url" command to download the logical backup file. url in the command indicates the URL from which you can download the logical backup file.
2.  Go to the path where the logical backup file is saved.

    ``` {#codeblock_jkk_xak_948}
    cd /home/mysql/
    ```

3.  Decompress the logical backup file.

    ``` {#codeblock_vbg_e93_joc}
    tar vizxf filename.tar.gz
    ```

     filename.tar.gz indicates the name of the logical backup file.

4.  Decompress the compressed SQL file.

    ``` {#codeblock_9nr_9op_gdo}
     gunzip filename.sql.gz
    ```

     filename.sql.gz indicates the name of the compressed SQL file.

5.  Import data to the destination database.

    ``` {#codeblock_t97_r7k_78c}
     mysql -u userName -p -h hostName -P port dbName < filename.sql
    ```

     filename.sql indicates the name of the decompressed SQL file.


