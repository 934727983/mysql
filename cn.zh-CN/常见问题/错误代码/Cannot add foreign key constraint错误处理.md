# Cannot add foreign key constraint错误处理 {#concept_185620 .concept}

## 错误信息 {#section_w17_i8o_nfq .section}

RDS for MySQL是支持外键约束的，但在创建外键约束时提示如下错误：

``` {#codeblock_30b_k0g_r7i}
Cannot add foreign key constraint
```

## 错误原因 {#section_u32_5t3_h5q .section}

要关联的字段在要关联的表中不是主键。

## 解决方案 {#section_btu_vq2_gp3 .section}

以tstudent表和tscore表为例说明如何解决此问题。

1.  先查看表结构，判断要关联的字段在要关联的表中是不是主键。

    ``` {#codeblock_ing_if8_f3v}
    mysql>show create table tstudent;
    +-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | Table           | Create Table                                                                                                                                                    |
    +-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | tstudent        | CREATE TABLE `tstudent` (
      `sno` varchar(4) NOT NULL DEFAULT '',
      `sname` varchar(3) DEFAULT NULL
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8 |
    +-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------+
    共返回 1 行记录,花费 267.17 ms.
    mysql>show create table tscore;
    +-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | Table           | Create Table                                                                                                                                                                                                                                                          |
    +-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | tscore          | CREATE TABLE `tscore` (
      `sno` char(4) DEFAULT NULL,
      `cno` char(3) DEFAULT NULL,
      `score` int(10) DEFAULT '0'
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8 |
    +-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    共返回 1 行记录,花费 128.94 ms.
    ```

    **说明：** 可以看到表tstudent没有主键。

2.  为表tstudent添加主键，命令如下：

    ``` {#codeblock_704_h84_xoc}
    alter table tstudent add primary key(sno);
    ```

3.  再次创建外键约束即可成功。

    ``` {#codeblock_8q3_1at_64a}
    mysql>alter table tscore add constraint fk_tscore_sno foreign key(sno) references tstudent(sno);
    执行成功,花费 161.55 ms.
    ```


